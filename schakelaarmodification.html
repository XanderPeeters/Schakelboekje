<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert GeoJSON to Excel/CSV</title>
</head>
<body>
    <input type="file" id="geojsonFileInput" accept=".geojson">
    <button onclick="convertToExcel()">Convert to Excel</button>
    <button onclick="convertToCSV()">Convert to CSV</button>

    <script>
        function convertToExcel() {
            const fileInput = document.getElementById('geojsonFileInput');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();

                reader.onload = function(event) {
                    const geojson = JSON.parse(event.target.result);

                    // Convert GeoJSON to XLSX format
                    const workbook = XLSX.utils.book_new();
                    const worksheet = XLSX.utils.json_to_sheet(geojson.features.map(feature => feature.properties));
                    XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

                    // Save the XLSX file
                    XLSX.writeFile(workbook, 'geojson_data.xlsx');
                };

                reader.readAsText(file);
            } else {
                alert('Please select a GeoJSON file.');
            }
        }

        function convertToCSV() {
            const fileInput = document.getElementById('geojsonFileInput');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();

                reader.onload = function(event) {
                    const geojson = JSON.parse(event.target.result);

                    // Convert GeoJSON to CSV format
                    const csv = Papa.unparse(geojson.features.map(feature => feature.properties));

                    // Save the CSV file
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'geojson_data.csv';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                };

                reader.readAsText(file);
            } else {
                alert('Please select a GeoJSON file.');
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</body>
</html>
